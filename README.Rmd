---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# QuickPed

<!-- badges: start -->
<!-- badges: end -->

To use QuickPed, visit <https://magnusdv.shinyapps.io/quickped>.

## What is QuickPed?
QuickPed is a web application for creating and plotting pedigrees on the fly. Once the pedigree is created it may be saved as an image, or as a text file in *ped format* (see below). You may also obtain various information about the pedigree, including coefficients of inbreeding, kinship and identity-by-descent.

QuickPed is powered by the [pedtools](https://github.com/magnusdv/pedtools) package and imports [kinship2](https://CRAN.R-project.org/package=kinship2) for plotting.

## Pairwise relationships
The *Relationships* feature of QuickPed provides information about pairwise relationships within the current pedigree. After selecting any two pedigree members, the user may click either `Coeffs` or `Describe`:

* `Coeffs`: This prints a variety of pedigree coefficients describing the relationship:
  * The inbreeding coefficient of each individual (this works for any number of selected members).
  * The kinship coefficient $\varphi$.
  * The IBD coefficients $\kappa = (\kappa_0, \kappa_1, \kappa_2)$, defined as the probabilities of sharing 0, 1, and 2 alleles identical by descent (IBD). These are well-defined only if both individuals are non-inbred.
  * The 9 condensed identity coefficients of Jacquard, $\Delta = (\Delta_1, ..., \Delta_9)$.
    
  More information about these coefficients can be found in the documentation of the [ribd](https://github.com/magnusdv/ribd) package, which is used in the calculations.
  
* `Describe`: This prints a verbal description of the relationship, generated by [verbalisr](https://github.com/magnusdv/verbalisr). (NB: This is still work in progress.)

## What is *ped format*?
A useful feature of QuickPed is to produce text files describing pedigrees in so-called *ped format*. Such files are often required by software for pedigree analysis.

For a simple illustration, consider this pedigree:

```{r trio-ped, echo = F, fig.height = 1.8, fig.width = 2.2, out.width = "25%", fig.align = "center"}
df = data.frame(id = 1:3, fid = c(0,0,1), mid = c(0,0,2), sex = c(1,2,2), aff = c(1,1,2))
x = pedtools::as.ped(df[1:4])
plot(x, aff = which(df$aff == 2), margins = c(1,1,1,1))
```

A text file describing this pedigree may contain the following.

```{r, echo = F, comment = NA}
print(df, row.names = F)
```

The columns are:

* `id`: Individual ID
* `fid`: Father's ID (or 0 if not included in the pedigree)
* `mid`: Mother's ID (or 0 if not inlcuded in the pedigree)
* `sex`: Sex (1 = male; 2 = female; 0 = unknown)
* `aff`: Affection status (1 = unaffected; 2 = affected; 0 = unknown)

It should be noted that the ped format is not completely standardised, and different software may use slightly different versions. For example, a first column with *Family ID* is sometimes required. Also, the `aff` column may not be needed in non-medical applications. These and other details may be specified when using QuickPed.
